require('dotenv').config();const express=require('express');const bodyParser=require('body-parser');const cors=require('cors');const {sequelize,Restaurant,MenuItem}=require('./models');
const app=express();app.use(cors());app.use(bodyParser.json());
app.use('/api/auth',require('./routes/auth'));
app.use('/api/restaurants',require('./routes/restaurants'));
app.use('/api/orders',require('./routes/orders'));
app.get('/healthz',(req,res)=>res.json({status:'ok'}));
async function init(){await sequelize.sync({alter:true});if(await Restaurant.count()===0){const r1=await Restaurant.create({name:'Spice Garden',cuisine:'Indian',rating:4.6,location:'Sector 12'});const r2=await Restaurant.create({name:'Burger Hub',cuisine:'Fast Food',rating:4.2,location:'Market Road'});const r3=await Restaurant.create({name:'Pizza Palace',cuisine:'Italian',rating:4.5,location:'Downtown'});const r4=await Restaurant.create({name:'Sushi Supreme',cuisine:'Japanese',rating:4.7,location:'Riverside'});const r5=await Restaurant.create({name:'Taco Fiesta',cuisine:'Mexican',rating:4.3,location:'North Mall'});const r6=await Restaurant.create({name:'Thai Basil',cuisine:'Thai',rating:4.4,location:'East Market'});const r7=await Restaurant.create({name:'Dragon Bowl',cuisine:'Chinese',rating:4.1,location:'Central Station'});await MenuItem.bulkCreate([{name:'Butter Chicken',price:250,RestaurantId:r1.id},{name:'Paneer Tikka',price:180,RestaurantId:r1.id},{name:'Garlic Naan',price:80,RestaurantId:r1.id},{name:'Biryani',price:320,RestaurantId:r1.id},{name:'Classic Burger',price:120,RestaurantId:r2.id},{name:'Cheese Burger',price:150,RestaurantId:r2.id},{name:'Fries',price:60,RestaurantId:r2.id},{name:'Milkshake',price:90,RestaurantId:r2.id},{name:'Margherita Pizza',price:280,RestaurantId:r3.id},{name:'Pepperoni Pizza',price:320,RestaurantId:r3.id},{name:'Garlic Bread',price:100,RestaurantId:r3.id},{name:'Coca Cola',price:50,RestaurantId:r3.id},{name:'Salmon Sushi',price:350,RestaurantId:r4.id},{name:'Tuna Rolls',price:300,RestaurantId:r4.id},{name:'Miso Soup',price:120,RestaurantId:r4.id},{name:'Tempura',price:280,RestaurantId:r4.id},{name:'Chicken Tacos',price:180,RestaurantId:r5.id},{name:'Beef Burrito',price:220,RestaurantId:r5.id},{name:'Nachos',price:140,RestaurantId:r5.id},{name:'Margarita',price:200,RestaurantId:r5.id},{name:'Green Curry',price:260,RestaurantId:r6.id},{name:'Pad Thai',price:240,RestaurantId:r6.id},{name:'Tom Yum Soup',price:150,RestaurantId:r6.id},{name:'Spring Rolls',price:120,RestaurantId:r6.id},{name:'Chow Mein',price:200,RestaurantId:r7.id},{name:'Fried Rice',price:210,RestaurantId:r7.id},{name:'Sweet & Sour Chicken',price:250,RestaurantId:r7.id},{name:'Egg Drop Soup',price:100,RestaurantId:r7.id}]);}}
init().then(()=>app.listen(process.env.PORT||4000));